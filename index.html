<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Primary Meta Tags -->
  <!-- TODO: Replace with your paper title and author names -->
  <meta name="title" content="LocalSearchBench: Benchmarking Agentic Search in Real-World Local Life Services">
  <!-- TODO: Write a compelling 150-160 character description of your research -->
  <meta name="description" content="BRIEF_DESCRIPTION_OF_YOUR_RESEARCH_CONTRIBUTION_AND_FINDINGS">
  <!-- TODO: Add 5-10 relevant keywords for your research area -->
  <meta name="keywords" content="KEYWORD1, KEYWORD2, KEYWORD3, machine learning, computer vision, AI">
  <!-- TODO: List all authors -->
  <meta name="author" content="FIRST_AUTHOR_NAME, SECOND_AUTHOR_NAME">
  <meta name="robots" content="index, follow">
  <meta name="language" content="English">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <!-- TODO: Replace with your institution or lab name -->
  <meta property="og:site_name" content="INSTITUTION_OR_LAB_NAME">
  <!-- TODO: Same as paper title above -->
  <meta property="og:title" content="PAPER_TITLE">
  <!-- TODO: Same as description above -->
  <meta property="og:description" content="BRIEF_DESCRIPTION_OF_YOUR_RESEARCH_CONTRIBUTION_AND_FINDINGS">
  <!-- TODO: Replace with your actual website URL -->
  <meta property="og:url" content="https://YOUR_DOMAIN.com/YOUR_PROJECT_PAGE">
  <!-- TODO: Create a 1200x630px preview image and update path -->
  <meta property="og:image" content="https://YOUR_DOMAIN.com/static/images/social_preview.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="PAPER_TITLE - Research Preview">
  <meta property="article:published_time" content="2024-01-01T00:00:00.000Z">
  <meta property="article:author" content="FIRST_AUTHOR_NAME">
  <meta property="article:section" content="Research">
  <meta property="article:tag" content="KEYWORD1">
  <meta property="article:tag" content="KEYWORD2">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <!-- TODO: Replace with your lab/institution Twitter handle -->
  <meta name="twitter:site" content="@YOUR_TWITTER_HANDLE">
  <!-- TODO: Replace with first author's Twitter handle -->
  <meta name="twitter:creator" content="@AUTHOR_TWITTER_HANDLE">
  <!-- TODO: Same as paper title above -->
  <meta name="twitter:title" content="PAPER_TITLE">
  <!-- TODO: Same as description above -->
  <meta name="twitter:description" content="BRIEF_DESCRIPTION_OF_YOUR_RESEARCH_CONTRIBUTION_AND_FINDINGS">
  <!-- TODO: Same as social preview image above -->
  <meta name="twitter:image" content="https://YOUR_DOMAIN.com/static/images/social_preview.png">
  <meta name="twitter:image:alt" content="PAPER_TITLE - Research Preview">

  <!-- Academic/Research Specific -->
  <meta name="citation_title" content="PAPER_TITLE">
  <meta name="citation_author" content="FIRST_AUTHOR_LAST, FIRST_AUTHOR_FIRST">
  <meta name="citation_author" content="SECOND_AUTHOR_LAST, SECOND_AUTHOR_FIRST">
  <meta name="citation_publication_date" content="2024">
  <meta name="citation_conference_title" content="CONFERENCE_NAME">
  <meta name="citation_pdf_url" content="https://YOUR_DOMAIN.com/static/pdfs/paper.pdf">
  
  <!-- Additional SEO -->
  <meta name="theme-color" content="#2563eb">
  <meta name="msapplication-TileColor" content="#2563eb">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://ajax.googleapis.com">
  <link rel="preconnect" href="https://documentcloud.adobe.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">


  <!-- TODO: Replace with your paper title and authors -->
  <title>LocalSearchBench: Benchmarking Agentic Search in Real-World Local Life Services</title>
  
  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link rel="apple-touch-icon" href="static/images/favicon.ico">
  
  <!-- Critical CSS - Load synchronously -->
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/index.css?v=5">
  
  <!-- Non-critical CSS - Load asynchronously -->
  <link rel="preload" href="static/css/bulma-carousel.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/bulma-slider.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/fontawesome.all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  <!-- Fallback for browsers that don't support preload -->
  <noscript>
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  </noscript>
  
  <!-- Fonts - Optimized loading -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Defer non-critical JavaScript -->
  <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script defer src="static/js/bulma-carousel.min.js"></script>
  <script defer src="static/js/bulma-slider.min.js"></script>
  <script defer src="static/js/config.js"></script>
  <script defer src="static/js/index.js?v=8&t=20251105"></script>
  
  <!-- ECharts for China Map -->
  <script defer src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  
  <!-- Structured Data for Academic Papers -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ScholarlyArticle",
    "headline": "PAPER_TITLE",
    "description": "BRIEF_DESCRIPTION_OF_YOUR_RESEARCH_CONTRIBUTION_AND_FINDINGS",
    "author": [
      {
        "@type": "Person",
        "name": "FIRST_AUTHOR_NAME",
        "affiliation": {
          "@type": "Organization",
          "name": "INSTITUTION_NAME"
        }
      },
      {
        "@type": "Person",
        "name": "SECOND_AUTHOR_NAME",
        "affiliation": {
          "@type": "Organization",
          "name": "INSTITUTION_NAME"
        }
      }
    ],
    "datePublished": "2024-01-01",
    "publisher": {
      "@type": "Organization",
      "name": "CONFERENCE_OR_JOURNAL_NAME"
    },
    "url": "https://YOUR_DOMAIN.com/YOUR_PROJECT_PAGE",
    "image": "https://YOUR_DOMAIN.com/static/images/social_preview.png",
    "keywords": ["KEYWORD1", "KEYWORD2", "KEYWORD3", "machine learning", "computer vision"],
    "abstract": "FULL_ABSTRACT_TEXT_HERE",
    "citation": "BIBTEX_CITATION_HERE",
    "isAccessibleForFree": true,
    "license": "https://creativecommons.org/licenses/by/4.0/",
    "mainEntity": {
      "@type": "WebPage",
      "@id": "https://YOUR_DOMAIN.com/YOUR_PROJECT_PAGE"
    },
    "about": [
      {
        "@type": "Thing",
        "name": "RESEARCH_AREA_1"
      },
      {
        "@type": "Thing", 
        "name": "RESEARCH_AREA_2"
      }
    ]
  }
  </script>
  
  <!-- Website/Organization Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "INSTITUTION_OR_LAB_NAME",
    "url": "https://YOUR_INSTITUTION_WEBSITE.com",
    "logo": "https://YOUR_DOMAIN.com/static/images/favicon.ico",
    "sameAs": [
      "https://twitter.com/YOUR_TWITTER_HANDLE",
      "https://github.com/YOUR_GITHUB_USERNAME"
    ]
  }
  </script>
</head>
<body>


  <!-- Scroll to Top Button -->
  <button class="scroll-to-top" onclick="scrollToTop()" title="Scroll to top" aria-label="Scroll to top">
    <i class="fas fa-chevron-up"></i>
  </button>

  <!-- More Works Dropdown -->
  <div class="more-works-container">
    <button class="more-works-btn" onclick="toggleMoreWorks()" title="View More Works from Agentic System X (AsX)">
      <i class="fas fa-flask"></i>
      More Works
      <i class="fas fa-chevron-down dropdown-arrow"></i>
    </button>
    <div class="more-works-dropdown" id="moreWorksDropdown">
      <div class="dropdown-header">
        <h4>More Works from Agentic System X (AsX)</h4>
        <button class="close-btn" onclick="toggleMoreWorks()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="works-list">
        <!-- TODO: Replace with your lab's related works -->
        <a href="https://arxiv.org/abs/2508.10293" class="work-item" target="_blank">
          <div class="work-info">
            <!-- TODO: Replace with actual paper title -->
            <h5>Promoting Efficient Reasoning with Verifiable Stepwise Reward</h5>
            <!-- TODO: Replace with brief description -->
            <p>Proposes a rule-based VSRM that assigns rewards via intermediate reasoning states to precisely address LRMs' overthinking.</p>
            <!-- TODO: Replace with venue and year -->
            <span class="work-venue">AAAI 2026.</span>
          </div>
          <i class="fas fa-external-link-alt"></i>
        </a>
        <!-- TODO: Add more related works or remove extra items -->
        <a href="https://arxiv.org/abs/2509.06980" class="work-item" target="_blank">
          <div class="work-info">
            <h5>RLFactory: A Plug-and-Play Reinforcement Learning Post-Training Framework for LLM Multi-Turn Tool-Use</h5>
            <p>RLFactory, a plug-and-play RL post-training framework for LLMs' multi-turn tool-use, solves key issues, outperforms larger models and boosts throughput.</p>
            <span class="work-venue">Under review.</span>
          </div>
          <i class="fas fa-external-link-alt"></i>
        </a>
        <a href="https://arxiv.org/abs/2510.25510" class="work-item" target="_blank">
          <div class="work-info">
            <h5>MTIR-SQL: Multi-turn Tool-Integrated Reasoning Reinforcement Learning for Text-to-SQL</h5>
            <p>MTIR-SQL proposes a multi-turn tool-integrated reinforcement learning framework for Text-to-SQL, extending GRPO with trajectory filtering and removing KL constraints to enhance training stability and query accuracy, achieving state-of-the-art performance on benchmark datasets.</p>
            <span class="work-venue">Under review.</span>
          </div>
          <i class="fas fa-external-link-alt"></i>
        </a>
      </div>
    </div>
  </div>

  <main id="main-content">
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <!-- TODO: Replace with your paper title -->
            <h1 class="title is-1 publication-title">
              <img src="static/images/meituan.png" alt="Meituan Logo" style="height: 0.9em; vertical-align: middle; margin-right: 0.3em;">
              LocalSearchBench: Benchmarking Agentic Search in Real-World
Local Life Services</h1>
            <div class="is-size-5 publication-authors">
  <!-- TODO: Replace with your paper authors and their personal links -->
  <div class="is-size-5 publication-authors">
              <!-- TODO: Replace with your paper authors and their personal links -->
              <span class="author-block">
                <a href="https://scholar.google.com/citations?hl=zh-CN&user=jB60BNsAAAAJ">Hang He</a></sup><sup style="color:#6fbf73;">1</sup>,</span>
                <span class="author-block">
                  <a href="https://scholar.google.com/citations?hl=zh-CN&user=SViqq9IAAAAJ" target="_blank">Chuhuai Yue</a></sup><sup style="color:#ed4b82;">2</sup>,</span>
                  <span class="author-block">
                    <a href="https://chengcheng-wan.github.io/" target="_blank">Chengcheng Wan</a></sup><sup style="color:#6fbf73;">1</sup><sup style="color:#000000;">,</sup><sup style="color:#1E90FF">6</sup>,</span>
                    <span class="author-block">
                      <a href="https://scholar.google.com/citations?view_op=list_works&hl=zh-CN&user=BcDA9BEAAAAJ" target="_blank">Chengqi Dong</a><sup style="color:#9400D3">3</sup>,</span>
                      <span class="author-block">
                        <a href="https://tingsu.github.io/" target="_blank">Ting Su</a></sup><sup style="color:#6fbf73;">1</sup>,</span>
                        <span class="author-block">
                          <a href="Sixth AUTHOR PERSONAL LINK" target="_blank">Mingxue Tian</a></sup><sup style="color:#4169E1">4</sup>,</span>
                          <span class="author-block">
                            <a href=Seventh AUTHOR PERSONAL LINK" target="_blank">Zhenfeng Liu</a></sup><sup style="color:#ffac33">5</sup>,</span>
                            <span class="author-block">
                              <a href="https://scholar.google.com/citations?user=yDdfap0AAAAJ&hl=en" target="_blank">Jiajun Chai*</a></sup><sup style="color:#ffac33">5</sup>,</span>
                              <span class="author-block">
                                <a href="https://scholar.google.com/citations?hl=en&user=H0kocJUAAAAJ" target="_blank">Xiaohan Wang</a></sup><sup style="color:#ffac33">5</sup>,</span>
                                <span class="author-block">
                                  <a href="https://openreview.net/profile?id=%7EYufei_zhang10" target="_blank">Yufei Zhang</a></sup><sup style="color:#ffac33">5</sup>,</span>
                                  <span class="author-block">
                                    <a href="https://cn.linkedin.com/in/liao-qun-71910a85" target="_blank">Qun Liao</a></sup><sup style="color:#ffac33">5</sup>,</span>
                                    <span class="author-block">
                                      <a href="https://gjyin.github.io/" target="_blank">Guojun Yin‚Ä†</a></sup><sup style="color:#ffac33">5</sup>,</span>
                                      <span class="author-block">
                                        <a href="https://openreview.net/profile?id=~Wei_Lin7" target="_blank">Wei Lin</a></sup><sup style="color:#ffac33">5</sup>
  </span>
</div>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup style="color:#6fbf73;">1</sup> East China Normal University,</span>
                    <span class="author-block"><sup style="color:#ed4b82">2</sup> Beijing Institute of Technology,</span>
                    <span class="author-block"><sup style="color:#9400D3">3</sup> University of Science and Technology
of China,</span>
                    <span class="author-block"><sup style="color:#4169E1">4</sup> Shanghai Jiaotong University,</span><br>
                    <span class="author-block"><sup style="color:#ffac33">5</sup> Meituan,</span>
                    <span class="author-block"><sup style="color:#1E90FF">6</sup>
Shanghai Innovation Institute</span>
                    <br>
                     <span class="author-block">
                  <small>* Project leader.</small>
                    </span>
                    <span class="author-block">
                  <small>‚Ä† Corresponding author.</small>
                    </span>
                    <br>
                <span class="author-block">
                  <small>Correspondence to: <code>hang.he[at]stu[dot]ecnu[dot]edu[dot]cn</code>, <code>chaijiajun[at]meituan[dot]com</code>, <code>yinguojun02[at]meituan[dot]com</code></small>
                </span>
                    <!-- TODO: Replace with your institution and conference/journal info -->
                    <!-- <span class="author-block"><br><sup>1</sup>Meituan</span> -->
                    <!-- TODO: Remove this line if no equal contribution -->
                    <!-- <span class="eql-cntrb"><br><sup>*</sup>Project leader</span> -->
                    <!-- TODO: Remove this line if no equal contribution -->
                    <!-- <span class="eql-cntrb"><br><sup>‚Ä†</sup>Corresponding author</span> -->
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- TODO: Update with your arXiv paper ID -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/<ARXIV PAPER ID>.pdf" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>


                    <!-- TODO: Update with your arXiv paper ID -->
                    <span class="link-block">
                      <a href="https://arxiv.org/abs/<ARXIV PAPER ID>" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="ai ai-arxiv"></i>
                      </span>
                      <span>arXiv</span>
                    </a>
                  </span>

                  <!-- TODO: Replace with your GitHub repository URL -->
                  <span class="link-block">
                    <a href="https://github.com/YOUR REPO HERE" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- Dataset Link. -->
                <span class="link-block">
                  <a href="https://huggingface.co/localsearchbench"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <!-- <i class="far fa-images"></i> -->
                        <p style="font-size:18px">ü§ó</p>
                        <!-- üîó -->
                    </span>
                    <span>Dataset</span>
                  </a>
                </span> 

                <!-- Leaderboard Link. -->
                <span class="link-block">
                  <a href="https://localsearchbench.github.io/#leaderboard"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <p style="font-size:18px">üèÜ</p>
                    </span>
                    <span>Leaderboard</span>
                  </a>
                </span> 

                <!-- Playground Link. -->
                <span class="link-block">
                  <a href="https://localsearchbench.github.io/#playground"
                     class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <p style="font-size:18px">üõ†Ô∏è</p>
                  </span>
                  <span>Playground</span>
                  </a>
                </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <!-- TODO: Replace with your paper abstract -->
          <p>
            Recent advances in large reasoning models (LRMs) have enabled agentic search systems to perform complex multi-step reasoning across multiple sources. 
            However, most research focuses on general information retrieval and rarely explores vertical domains with unique challenges. 
            In this work, we focus on local life services and introduce <b>LocalSearchBench</b>, which encompass diverse and complex business scenarios. 
            Real-world queries in this domain are often ambiguous and require multi-hop reasoning across merchants and products, remaining challenging and not fully addressed. 
            As the first comprehensive benchmark for agentic search in local life services, <b>LocalSearchBench</b> includes over 1,300,000 high-quality entries from various cities and business types. 
            We construct 900 multi-hop QA tasks based on real user queries, challenging agents to understand questions and retrieve information in multiple steps. 
            We also developed <b>LocalPlayground</b>, a unified environment integrating multiple tools for agent interaction. 
            Experiments show that even state-of-the-art LRMs struggle on  <b>LocalSearchBench</b>: the best model (DeepSeek-V3.1) achieves only 34.34% correctness, and most models have issues with completeness (average 77.33%) and faithfulness (average 61.99%). 
            This highlights the need for specialized benchmarks and domain-specific agent training in local life services. 
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Playground Section -->
<section class="section" id="playground">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">üõ†Ô∏è LocalPlayground</h2>
        <div class="content has-text-justified">
          <p style="text-align: center;">
            Try our interactive playground to test different agentic search methods on LocalSearchBench.
            Select tools, enter queries, and see how different approaches perform.
          </p>
          
          <!-- Backend Setup Notice -->
          <div class="notification is-warning is-light" style="margin-top: 1rem; margin-bottom: 1rem;">
            <p style="text-align: center; margin-bottom: 0.5rem;">
              <strong>‚ö†Ô∏è Interactive Feature:</strong> This playground requires a backend server.
            </p>
            <p style="text-align: center; margin: 0;">
              <a href="QUICK_START.md" target="_blank" style="margin: 0 0.5rem;">üìñ Quick Start Guide</a> |
              <a href="DEPLOYMENT.md" target="_blank" style="margin: 0 0.5rem;">üöÄ Full Deployment</a> |
              <a href="javascript:void(0)" onclick="alert('Run: cd server && ./deploy.sh --dev\n\nOr try Gradio version: ./run_gradio.sh')" style="margin: 0 0.5rem;">‚ö° Quick Setup</a>
            </p>
          </div>
          
          <div class="notification is-info is-light">
            <p style="text-align: center; margin: 0;">
              <strong>üìç Supported Cities:</strong> Currently supports <strong>Shanghai</strong>, <strong>Beijing</strong>, <strong>Guangzhou</strong>, <strong>Shenzhen</strong>, <strong>Wuhan</strong>, <strong>Chongqing</strong>, <strong>Chengdu</strong>, <strong>Suzhou</strong>, and <strong>Hangzhou</strong>. Other cities are under development.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Playground Interface -->
    <div class="playground-container">
      <!-- Tool Selection -->
      <div class="tool-selection">
        <h3 class="subtitle is-5">Select Search Method</h3>
        <div class="tabs is-centered is-boxed">
          <ul>
            <li data-tab="web">
              <a onclick="switchTool('web')">
                <span class="icon is-small"><i class="fas fa-globe"></i></span>
                <span>Web Search</span>
              </a>
            </li>
            <li class="is-active" data-tab="rag">
              <a onclick="switchTool('rag')">
                <span class="icon is-small"><i class="fas fa-search"></i></span>
                <span>RAG Search</span>
              </a>
            </li>
            <li data-tab="agentic">
              <a onclick="switchTool('agentic')">
                <span class="icon is-small"><i class="fas fa-robot"></i></span>
                <span>Agentic Search</span>
              </a>
            </li>
          </ul>
        </div>
      </div>

      <!-- RAG Search Panel -->
      <div class="tool-panel active" id="rag-panel">
        <div class="panel-content">
          <!-- City and Location Selection -->
          <div class="columns">
            <div class="column is-4">
          <div class="field">
                <label class="label">City (ÂüéÂ∏Ç)</label>
            <div class="control">
                  <div class="select is-fullwidth">
                    <select id="rag-city">
                      <option value="shanghai">‰∏äÊµ∑ Shanghai</option>
                      <option value="beijing">Âåó‰∫¨ Beijing</option>
                      <option value="guangzhou">ÂπøÂ∑û Guangzhou</option>
                      <option value="shenzhen">Ê∑±Âú≥ Shenzhen</option>
                      <option value="hangzhou">Êù≠Â∑û Hangzhou</option>
                      <option value="suzhou">ËãèÂ∑û Suzhou</option>
                      <option value="chengdu">ÊàêÈÉΩ Chengdu</option>
                      <option value="chongqing">ÈáçÂ∫Ü Chongqing</option>
                      <option value="wuhan">Ê≠¶Ê±â Wuhan</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="column is-8">
              <div class="field">
                <label class="label">Location (‰ΩçÁΩÆ)</label>
                <div class="control">
                  <input class="input" type="text" id="rag-location" placeholder="e.g., Â§ñÊª©, ‰∫îÈÅìÂè£, Â§©Ê≤≥Âå∫">
                </div>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">Query (Êü•ËØ¢ÂÜÖÂÆπ)</label>
            <div class="control">
              <textarea class="textarea" id="rag-query" placeholder="e.g., ÊúâÂì™‰∫õËØÑÂàÜÈ´òÁöÑÁÅ´ÈîÖÂ∫ó"></textarea>
            </div>
          </div>

          <div class="columns">
            <div class="column">
              <div class="field">
                <label class="label">Top-K Results</label>
                <div class="control">
                  <input class="input" type="number" id="rag-topk" value="10" readonly disabled>
                </div>
              </div>
            </div>
            <div class="column">
              <!-- Empty column for spacing -->
            </div>
          </div>

          <div class="columns">
            <div class="column">
              <div class="field">
                <label class="label">Retrieval Model</label>
                <div class="control">
                  <input class="input" type="text" id="rag-retriever" value="Qwen3-Embedding-8B" readonly disabled>
                </div>
              </div>
            </div>
            <div class="column">
              <div class="field">
                <label class="label">Reranker Model</label>
                <div class="control">
                  <input class="input" type="text" id="rag-reranker" value="Qwen3-Reranker-8B" readonly disabled>
                </div>
              </div>
            </div>
          </div>

          <div class="field">
            <div class="control">
              <button class="button is-primary is-fullwidth" onclick="runRAG()">
                <span class="icon"><i class="fas fa-play"></i></span>
                <span>Run RAG Search</span>
              </button>
            </div>
          </div>

          <!-- Results Area -->
          <div class="results-area" id="rag-results" style="display: none;">
            <!-- Results header with collapse button -->
            <div class="results-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
              <h3 class="title is-5">Search Results</h3>
              <button class="button is-small" onclick="toggleRAGResults()" id="rag-toggle-btn">
                <span class="icon"><i class="fas fa-chevron-up"></i></span>
                <span>Collapse</span>
              </button>
            </div>
            
            <!-- Collapsible results content -->
            <div id="rag-results-content">
              <!-- Summary text (without box) -->
              <div class="generated-answer" id="generated-answer"></div>
              
              <!-- Retrieved merchants -->
              <div class="retrieved-docs" id="retrieved-docs"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Web Search Panel -->
      <div class="tool-panel" id="web-panel">
        <div class="panel-content">
          <div class="notification is-info is-light">
            <p><strong>Web Search</strong> performs traditional keyword-based search across local merchants and products.</p>
          </div>
          
          <!-- City and Location Selection -->
          <div class="columns">
            <div class="column is-4">
          <div class="field">
                <label class="label">City (ÂüéÂ∏Ç)</label>
            <div class="control">
                  <div class="select is-fullwidth">
                    <select id="web-city">
                      <option value="shanghai">‰∏äÊµ∑ Shanghai</option>
                      <option value="beijing">Âåó‰∫¨ Beijing</option>
                      <option value="guangzhou">ÂπøÂ∑û Guangzhou</option>
                      <option value="shenzhen">Ê∑±Âú≥ Shenzhen</option>
                      <option value="hangzhou">Êù≠Â∑û Hangzhou</option>
                      <option value="suzhou">ËãèÂ∑û Suzhou</option>
                      <option value="chengdu">ÊàêÈÉΩ Chengdu</option>
                      <option value="chongqing">ÈáçÂ∫Ü Chongqing</option>
                      <option value="wuhan">Ê≠¶Ê±â Wuhan</option>
                    </select>
            </div>
          </div>
              </div>
            </div>
            <div class="column is-8">
              <div class="field">
                <label class="label">Location (‰ΩçÁΩÆ)</label>
                <div class="control">
                  <input class="input" type="text" id="web-location" placeholder="e.g., Â§ñÊª©, ‰∫îÈÅìÂè£, Â§©Ê≤≥Âå∫">
                </div>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">Query (Êü•ËØ¢ÂÜÖÂÆπ)</label>
            <div class="control">
              <textarea class="textarea" id="web-query" placeholder="e.g., ÊúâÂì™‰∫õËØÑÂàÜÈ´òÁöÑÁÅ´ÈîÖÂ∫ó"></textarea>
            </div>
          </div>
          
          <div class="field">
            <label class="label">Top-K Results</label>
            <div class="control">
              <input class="input" type="number" id="web-topk" value="10" min="1" max="50">
            </div>
          </div>
          <div class="field">
            <div class="control">
              <button class="button is-primary is-fullwidth" onclick="runWebSearch()">
                <span class="icon"><i class="fas fa-play"></i></span>
                <span>Run Web Search</span>
              </button>
            </div>
          </div>
          <!-- Results Area -->
          <div class="results-area" id="web-results" style="display: none;">
            <!-- Results header with collapse button -->
            <div class="results-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
              <h4 class="subtitle is-6" style="margin-bottom: 0;">Search Results</h4>
              <button class="button is-small" onclick="toggleWebResults()" id="web-toggle-btn">
                <span class="icon"><i class="fas fa-chevron-up"></i></span>
                <span>Collapse</span>
              </button>
            </div>
            <!-- Collapsible results content -->
            <div id="web-results-content">
              <div class="search-results" id="web-search-results"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Agentic Search Panel -->
      <div class="tool-panel" id="agentic-panel">
        <div class="panel-content">
          <div class="notification is-info is-light">
            <p><strong>Agentic Search</strong> uses LLM-powered agents to perform multi-step reasoning and tool use.</p>
          </div>
          
          <!-- City and Location Selection -->
          <div class="columns">
            <div class="column is-4">
          <div class="field">
                <label class="label">City (ÂüéÂ∏Ç)</label>
            <div class="control">
                  <div class="select is-fullwidth">
                    <select id="agentic-city">
                      <option value="shanghai">‰∏äÊµ∑ Shanghai</option>
                      <option value="beijing">Âåó‰∫¨ Beijing</option>
                      <option value="guangzhou">ÂπøÂ∑û Guangzhou</option>
                      <option value="shenzhen">Ê∑±Âú≥ Shenzhen</option>
                      <option value="hangzhou">Êù≠Â∑û Hangzhou</option>
                      <option value="suzhou">ËãèÂ∑û Suzhou</option>
                      <option value="chengdu">ÊàêÈÉΩ Chengdu</option>
                      <option value="chongqing">ÈáçÂ∫Ü Chongqing</option>
                      <option value="wuhan">Ê≠¶Ê±â Wuhan</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div class="column is-8">
              <div class="field">
                <label class="label">Location (‰ΩçÁΩÆ)</label>
                <div class="control">
                  <input class="input" type="text" id="agentic-location" placeholder="e.g., Â§ñÊª©, ‰∫îÈÅìÂè£, Â§©Ê≤≥Âå∫">
                </div>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label">Query (Êü•ËØ¢ÂÜÖÂÆπ)</label>
            <div class="control">
              <textarea class="textarea" id="agentic-query" placeholder="e.g., ÊúâÂì™‰∫õËØÑÂàÜÈ´òÁöÑÁÅ´ÈîÖÂ∫ó"></textarea>
            </div>
          </div>

          <div class="field">
            <label class="label">LRM Model</label>
            <div class="control">
              <div class="select is-fullwidth">
                <select id="agentic-model">
                  <optgroup label="Proprietary LRMs">
                    <option value="gpt-4.1">üü¢ GPT-4.1</option>
                    <option value="gemini-2.5-pro">üîµ Gemini-2.5-Pro</option>
                    <option value="qwen-plus-latest">üîÆ Qwen-Plus-Latest</option>
                    <option value="longcat-large-32k">üü¢ LongCat-Large-32K</option>
                    <option value="hunyuan-t1">Hunyuan-T1</option>
                  </optgroup>
                  <optgroup label="Open-source LRMs">
                    <option value="qwen3-235b-a22b">üîÆ Qwen3-235B-A22B</option>
                    <option value="qwen3-32b">üîÆ Qwen3-32B</option>
                    <option value="qwen3-14b">üîÆ Qwen3-14B</option>
                    <option value="glm-4.5">üîµ GLM-4.5</option>
                    <option value="deepseek-v3.1" selected>üî∑ Deepseek-V3.1</option>
                  </optgroup>
                </select>
              </div>
            </div>
          </div>

          <div class="field">
            <div class="control">
              <button class="button is-primary is-fullwidth" onclick="runAgenticSearch()">
                <span class="icon"><i class="fas fa-play"></i></span>
                <span>Run Agentic Search</span>
              </button>
            </div>
          </div>

          <!-- Results Area -->
          <div class="results-area" id="agentic-results" style="display: none;">
            <!-- Results header with collapse button -->
            <div class="results-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
              <h4 class="subtitle is-6" style="margin-bottom: 0;">Search Results</h4>
              <button class="button is-small" onclick="toggleAgenticResults()" id="agentic-toggle-btn">
                <span class="icon"><i class="fas fa-chevron-up"></i></span>
                <span>Collapse</span>
              </button>
            </div>
            <!-- Collapsible results content -->
            <div id="agentic-results-content">
              <h4 class="subtitle is-6">Search Process</h4>
              <div class="search-process" id="search-process"></div>
              
              <h4 class="subtitle is-6" style="margin-top: 1.5rem;">Final Answer</h4>
              <div class="generated-answer" id="agentic-answer"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Example Queries -->
    <div class="example-queries" style="margin-top: 2rem;">
      <h3 class="subtitle is-5 has-text-centered">Example Queries</h3>
      <div class="columns is-multiline">
        <div class="column is-4">
          <div class="example-card" onclick="loadExample(0)">
            <p class="has-text-weight-semibold">üç≤ Restaurant Search</p>
            <p class="is-size-7">‰∏äÊµ∑ + Â§ñÊª© + È§êÂéÖ</p>
          </div>
        </div>
        <div class="column is-4">
          <div class="example-card" onclick="loadExample(1)">
            <p class="has-text-weight-semibold">üî• Hotpot Restaurant</p>
            <p class="is-size-7">Âåó‰∫¨ + ‰∫îÈÅìÂè£ + ÁÅ´ÈîÖÂ∫ó</p>
          </div>
        </div>
        <div class="column is-4">
          <div class="example-card" onclick="loadExample(2)">
            <p class="has-text-weight-semibold">üé¨ Entertainment</p>
            <p class="is-size-7">Ê∑±Âú≥ + ÂçóÂ±±Âå∫ + ÁîµÂΩ±Èô¢</p>
          </div>
        </div>
        <div class="column is-4">
          <div class="example-card" onclick="loadExample(3)">
            <p class="has-text-weight-semibold">üõçÔ∏è Shopping</p>
            <p class="is-size-7">ÂπøÂ∑û + Â§©Ê≤≥Âå∫ + ÁîüÊó•ËõãÁ≥ï</p>
          </div>
        </div>
        <div class="column is-4">
          <div class="example-card" onclick="loadExample(4)">
            <p class="has-text-weight-semibold">‚òï Coffee Shop</p>
            <p class="is-size-7">ÊàêÈÉΩ + Êò•ÁÜôË∑Ø + ÂíñÂï°Â∫ó</p>
          </div>
        </div>
        <div class="column is-4">
          <div class="example-card" onclick="loadExample(5)">
            <p class="has-text-weight-semibold">üè® Hotel Booking</p>
            <p class="is-size-7">Ê≠¶Ê±â + Ê≠¶ÊòåÁ´ô + ÈÖíÂ∫ó</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End Playground -->

<!-- Overview Section -->
<section class="section hero is-light" id="overview">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">üìä Overview</h2>
        <div class="content has-text-justified">
          <p style="text-align: center;">
            An overview of LocalSearchBench architecture, benchmark statistics, and evaluation framework.
          </p>
        </div>
      </div>
    </div>

    <!-- Overview Image -->
    <div class="overview-container" style="margin-top: 2rem;">
      <figure class="image" style="max-width: 80%; margin: 0 auto;">
        <img src="static/images/overview-github.png" alt="LocalSearchBench Overview" style="width: 100%; height: auto;">
      </figure>
    </div>

    <!-- Difficulty Grading System Description -->
    <div class="content has-text-justified" style="margin-top: 2rem;">
      <p style="text-align: center;">
        We are the <strong>first</strong> to propose a difficulty grading system (L1-L5) for agentic search in the local life services domain, systematically defining query difficulty levels from simple to complex.
      </p>
    </div>

    <!-- China Map with Cities -->
    <div class="content has-text-justified" style="margin-top: 2rem;">
      <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">üìç Supported Cities</h3>
      <div class="overview-container" style="margin-top: 1rem;">
        <div id="chinaMap" style="width: 100%; height: 600px; min-height: 600px; margin: 0 auto; background-color: #f8f9fa; border-radius: 8px; position: relative;"></div>
      </div>
    </div>

    <!-- Jin Zi Ta Image -->
    <div class="overview-container" style="margin-top: 1rem;">
      <figure class="image" style="max-width: 100%; margin: 0 auto;">
        <img src="static/images/jinzita.png" alt="LocalSearchBench Statistics" style="width: 100%; height: auto;">
      </figure>
    </div>

    <!-- Multi-hop Query Example Description -->
    <div class="content has-text-justified" style="margin-top: 2rem;">
      <p style="text-align: center;">
        The following example illustrates a Multi-hop QA from our benchmark, demonstrating how the system performs iterative retrieval across multiple rounds to fulfill complex planning requirements.
      </p>
    </div>

    <!-- GitHub Example Image -->
    <div class="overview-container" style="margin-top: 1rem;">
      <figure class="image" style="max-width: 50%; margin: 0 auto;">
        <img src="static/images/github-ex.png" alt="LocalSearchBench GitHub Example" style="width: 100%; height: auto;">
      </figure>
    </div>
  </div>
</section>
<!-- End Overview -->

<!-- Leaderboard Section -->
<section class="section" id="leaderboard">
  <div class="container is-max-fullhd">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full">
        <h2 class="title is-3">üèÜ Leaderboard</h2>
        <div class="content has-text-justified">
          <p style="text-align: center;">
            Performance of various models on LocalSearchBench. Evaluated on correctness, completeness, fluency, faithfulness, and safety.
          </p>
        </div>
      </div>
    </div>

    <!-- Leaderboard Table -->
    <div class="table-container">
      <table class="table is-striped is-hoverable is-fullwidth leaderboard-table" id="leaderboard-table">
        <thead>
          <tr>
            <th>Model</th>
            <th class="sortable" data-column="0" data-type="number">Avg. tool calls <span class="sort-arrow"></span></th>
            <th class="sortable" data-column="1" data-type="number">Avg. rounds <span class="sort-arrow"></span></th>
            <th class="sortable" data-column="2" data-type="number">Correctness (%) <span class="sort-arrow"></span></th>
            <th class="sortable" data-column="3" data-type="number">Completeness (%) <span class="sort-arrow"></span></th>
            <th class="sortable" data-column="4" data-type="number">Fluency (%) <span class="sort-arrow"></span></th>
            <th class="sortable" data-column="5" data-type="number">Faithfulness (%) <span class="sort-arrow"></span></th>
            <th class="sortable" data-column="6" data-type="number">Safety (%) <span class="sort-arrow"></span></th>
          </tr>
        </thead>
        <tbody>
          <tr data-values='[1.72, 2.70, 26.76, 75.42, 71.54, 72.63, 81.00]'>
            <td><img src="static/images/logo/icon-chatgpt (1).png" alt="GPT" class="model-logo"> <strong>GPT-4.1</strong></td>
            <td>1.72</td>
            <td>2.70</td>
            <td>26.76</td>
            <td>75.42</td>
            <td>71.54</td>
            <td>72.63</td>
            <td>81.00</td>
          </tr>
          <tr data-values='[1.89, 2.86, 26.09, 77.93, 73.50, 78.26, 83.81]'>
            <td><img src="static/images/logo/google.png" alt="Gemini" class="model-logo"> <strong>Gemini-2.5-Pro</strong></td>
            <td>1.89</td>
            <td>2.86</td>
            <td>26.09</td>
            <td>77.93</td>
            <td>73.50</td>
            <td>78.26</td>
            <td>83.81</td>
          </tr>
          <tr data-values='[2.59, 3.12, 32.79, 80.94, 73.65, 68.68, 83.14]'>
            <td><img src="static/images/logo/qwen.png" alt="Qwen" class="model-logo"> <strong>Qwen-Plus-Latest</strong></td>
            <td>2.59</td>
            <td>3.12</td>
            <td>32.79</td>
            <td>80.94</td>
            <td>73.65</td>
            <td>68.68</td>
            <td>83.14</td>
          </tr>
          <tr data-values='[2.73, 3.22, 33.19, 80.51, 73.40, 60.80, 81.14]'>
            <td><img src="static/images/logo/longcat.png" alt="LongCat" class="model-logo"> <strong>LongCat-Large-32K</strong></td>
            <td>2.73</td>
            <td>3.22</td>
            <td>33.19</td>
            <td>80.51</td>
            <td>73.40</td>
            <td>60.80</td>
            <td>81.14</td>
          </tr>
          <tr data-values='[2.30, 3.15, 32.94, 80.59, 73.00, 63.77, 84.71]'>
            <td><img src="static/images/logo/ai_hunyuan.png" alt="Hunyuan" class="model-logo"> <strong>Hunyuan-T1</strong></td>
            <td>2.30</td>
            <td>3.15</td>
            <td>32.94</td>
            <td>80.59</td>
            <td>73.00</td>
            <td>63.77</td>
            <td>84.71</td>
          </tr>
          <tr data-values='[2.04, 2.85, 26.42, 76.25, 70.97, 48.54, 81.54]'>
            <td><img src="static/images/logo/qwen.png" alt="Qwen" class="model-logo"> <strong>Qwen3-235B-A22B</strong></td>
            <td>2.04</td>
            <td>2.85</td>
            <td>26.42</td>
            <td>76.25</td>
            <td>70.97</td>
            <td>48.54</td>
            <td>81.54</td>
          </tr>
          <tr data-values='[2.48, 2.89, 24.75, 71.37, 70.17, 40.84, 81.34]'>
            <td><img src="static/images/logo/qwen.png" alt="Qwen" class="model-logo"> <strong>Qwen3-32B</strong></td>
            <td>2.48</td>
            <td>2.89</td>
            <td>24.75</td>
            <td>71.37</td>
            <td>70.17</td>
            <td>40.84</td>
            <td>81.34</td>
          </tr>
          <tr data-values='[2.35, 2.81, 28.43, 73.48, 70.54, 52.43, 81.67]'>
            <td><img src="static/images/logo/qwen.png" alt="Qwen" class="model-logo"> <strong>Qwen3-14B</strong></td>
            <td>2.35</td>
            <td>2.81</td>
            <td>28.43</td>
            <td>73.48</td>
            <td>70.54</td>
            <td>52.43</td>
            <td>81.67</td>
          </tr>
          <tr data-values='[2.73, 3.66, 33.78, 76.76, 71.81, 73.12, 76.66]'>
            <td><img src="static/images/logo/logo_chatglm.png" alt="ChatGLM" class="model-logo"> <strong>GLM-4.5</strong></td>
            <td>2.73</td>
            <td>3.66</td>
            <td>33.78</td>
            <td>76.76</td>
            <td>71.81</td>
            <td>73.12</td>
            <td>76.66</td>
          </tr>
          <tr data-values='[3.43, 4.02, 34.34, 80.00, 72.39, 60.80, 81.48]'>
            <td><img src="static/images/logo/deepseek.png" alt="Deepseek" class="model-logo"> <strong>Deepseek-V3.1</strong></td>
            <td>3.43</td>
            <td>4.02</td>
            <td>34.34</td>
            <td>80.00</td>
            <td>72.39</td>
            <td>60.80</td>
            <td>81.48</td>
          </tr>
          <!-- Average -->
          <tr data-values='[2.43, 3.13, 29.95, 77.33, 72.10, 61.99, 81.65]' class="average-row">
            <td><strong>Average</strong></td>
            <td>2.43</td>
            <td>3.13</td>
            <td>29.95</td>
            <td>77.33</td>
            <td>72.10</td>
            <td>61.99</td>
            <td>81.65</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="content has-text-centered" style="margin-top: 1.5rem;">
      <p class="is-size-7">
        <em>Note: Results are based on our evaluation framework. See paper for detailed methodology.</em>
      </p>
    </div>
  </div>
</section>
<!-- End Leaderboard -->

<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <div class="bibtex-header">
        <h2 class="title">BibTeX</h2>
        <button class="copy-bibtex-btn" onclick="copyBibTeX()" title="Copy BibTeX to clipboard">
          <i class="fas fa-copy"></i>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <pre id="bibtex-code"><code>@article{YourPaperKey2024,
  title={Your Paper Title Here},
  author={First Author and Second Author and Third Author},
  journal={Conference/Journal Name},
  year={2024},
  url={https://your-domain.com/your-project-page}
}</code></pre>
    </div>
</section>
<!--End BibTex citation -->

<!-- Visitor Map Section -->
<section class="section" id="visitor-map">
  <div class="container is-max-desktop">
    <div class="content has-text-centered">
      <h2 class="title">Visitor Statistics</h2>
      <div class="visitor-map-container">
        <script type="text/javascript" id="clustrmaps" src="//clustrmaps.com/map_v2.js?d=Pq3_L1xyHtD5UU0fPJgHdqOsjTFXctKkw9OC6Px4iLg&cl=ffffff&w=a"></script>
      </div>
    </div>
  </div>
</section>
<!-- End Visitor Map Section -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the¬†<a href="https://nerfies.github.io" target="_blank">Nerfies</a>¬†project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Visitor Counter -->
<div style="text-align: center; padding: 20px 0; background-color: #f5f5f5; border-top: 1px solid #e0e0e0;">
  <h3 style="color: #4a90e2; font-size: 18px; margin-bottom: 10px; font-weight: 600;">Visitors</h3>
  <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5p0v8v0v0v0&amp;m=7&amp;c=e63100&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=90&amp;lx=-420&amp;ly=420&amp;hi=20&amp;he=7&amp;hc=a8ddff&amp;rs=80" async="async"></script>
</div>
<!-- End of Visitor Counter -->

<!-- ECharts China Map Initialization -->
<script>
(function() {
  let echartsRetryCount = 0;
  let domRetryCount = 0;
  const maxEChartsRetries = 100; // 10 seconds max wait for ECharts
  const maxDomRetries = 100; // 10 seconds max wait for DOM
  
  // City coordinates - 9 supported cities
  const cityData = [
    { name: 'Âåó‰∫¨', value: [116.4074, 39.9042, 1] },
    { name: '‰∏äÊµ∑', value: [121.4737, 31.2304, 1] },
    { name: 'ÂπøÂ∑û', value: [113.2644, 23.1291, 1] },
    { name: 'Ê∑±Âú≥', value: [114.0579, 22.5431, 1] },
    { name: 'Ê≠¶Ê±â', value: [114.3162, 30.5810, 1] },
    { name: 'ÈáçÂ∫Ü', value: [106.5516, 29.5630, 1] },
    { name: 'ÊàêÈÉΩ', value: [104.0668, 30.5728, 1] },
    { name: 'ËãèÂ∑û', value: [120.5853, 31.2989, 1] },
    { name: 'Êù≠Â∑û', value: [120.1536, 30.2875, 1] }
  ];
  
  // Multiple data sources as fallback
  // Primary: Use locally hosted map data (works on GitHub Pages)
  const mapDataSources = [
    {
      // Primary: Locally hosted map data (already uploaded to GitHub Pages)
      full: './china_full.json',
      regular: './china.json'
    }
  ];
  
  // Wait for DOM to be ready
  function waitForDOM() {
    const mapContainer = document.getElementById('chinaMap');
    if (!mapContainer) {
      if (domRetryCount < maxDomRetries) {
        domRetryCount++;
        setTimeout(waitForDOM, 100);
      } else {
        console.error('Map container not found after maximum retries');
      }
      return;
    }
    
    // DOM is ready, now wait for ECharts
    waitForECharts();
  }
  
  // Wait for ECharts to be loaded
  function waitForECharts() {
    if (typeof echarts === 'undefined') {
      if (echartsRetryCount < maxEChartsRetries) {
        echartsRetryCount++;
        setTimeout(waitForECharts, 100);
      } else {
        const mapContainer = document.getElementById('chinaMap');
        if (mapContainer) {
          mapContainer.innerHTML = '<p style="text-align: center; color: #999; padding: 50px;">ECharts library loading failed. Please refresh the page.</p>';
        }
        console.error('ECharts library not loaded after maximum retries');
      }
      return;
    }
    
    // Both DOM and ECharts are ready, initialize map
    initChinaMap();
  }
  
  // Initialize the map
  function initChinaMap() {
    const mapContainer = document.getElementById('chinaMap');
    if (!mapContainer) {
      console.error('Map container not found');
      return;
    }
    
    // Show loading state
    mapContainer.innerHTML = '<p style="text-align: center; color: #666; padding: 50px;">Loading map data...</p>';
    
    // Initialize chart
    let myChart;
    try {
      myChart = echarts.init(mapContainer);
      if (!myChart) {
        throw new Error('Failed to initialize ECharts');
      }
    } catch (error) {
      console.error('Error initializing ECharts:', error);
      mapContainer.innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">' +
        '<h4 style="color: #4a90e2; margin-bottom: 20px;">üìç Supported Cities</h4>' +
        '<p style="font-size: 16px; line-height: 2;">' + cityData.map(city => city.name).join(', ') + '</p>' +
        '</div>';
      return;
    }
    
    // Try to load map data from multiple sources
    function tryLoadMap(sourceIndex) {
      if (sourceIndex >= mapDataSources.length) {
        // All sources failed, show cities with geo coordinate system (better than x/y axis)
        console.warn('All map data sources failed, showing cities with geo coordinates');
        const mapContainer = document.getElementById('chinaMap');
        if (mapContainer) {
          mapContainer.innerHTML = ''; // Clear loading message
        }
        try {
          showCitiesWithGeo(myChart);
        } catch (e) {
          console.error('Error showing cities with geo:', e);
          // Final fallback: show city list as text
          if (mapContainer) {
            mapContainer.innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">' +
              '<h4 style="color: #4a90e2; margin-bottom: 20px;">üìç Supported Cities</h4>' +
              '<p style="font-size: 16px; line-height: 2;">' + cityData.map(city => city.name).join(', ') + '</p>' +
              '<p style="font-size: 12px; color: #999; margin-top: 20px;">Map data unavailable. Please check your network connection.</p>' +
              '</div>';
          }
        }
        return;
      }
      
      const source = mapDataSources[sourceIndex];
      console.log(`[Map Loader] Trying source ${sourceIndex + 1}/${mapDataSources.length}:`, source.full);
      
      // Add timeout to fetch (reduced to 8 seconds for faster fallback)
      const controller = new AbortController();
      const timeoutId = setTimeout(() => controller.abort(), 8000); // 8 second timeout
      
      // Try to load both full and regular versions
      Promise.all([
        fetch(source.full, {
          mode: 'cors',
          cache: 'default',
          signal: controller.signal
        }).then(response => {
          console.log(`[Map Loader] Response from ${source.full}:`, response.status, response.statusText);
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          return response.json().then(data => {
            console.log(`[Map Loader] Successfully parsed JSON from ${source.full}, type:`, data?.type);
            return data;
          });
        }).catch(err => {
          console.warn(`[Map Loader] Failed to load full version from ${source.full}:`, err.message);
          return null;
        }),
        fetch(source.regular, {
          mode: 'cors',
          cache: 'default',
          signal: controller.signal
        }).then(response => {
          console.log(`[Map Loader] Response from ${source.regular}:`, response.status, response.statusText);
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          return response.json().then(data => {
            console.log(`[Map Loader] Successfully parsed JSON from ${source.regular}, type:`, data?.type);
            return data;
          });
        }).catch(err => {
          console.warn(`[Map Loader] Failed to load regular version from ${source.regular}:`, err.message);
          return null;
        })
      ])
        .then(([chinaFullJson, chinaJson]) => {
          clearTimeout(timeoutId);
          
          // Use full version if available, otherwise use regular
          const mapJson = chinaFullJson || chinaJson;
          const shadowJson = chinaJson || chinaFullJson;
          
          if (!mapJson) {
            throw new Error('Both full and regular versions failed to load');
          }
          
          if (!mapJson.type || mapJson.type !== 'FeatureCollection') {
            console.error('[Map Loader] Invalid map data format:', mapJson.type);
            throw new Error('Invalid map data format: expected FeatureCollection');
          }
          
          console.log('[Map Loader] Valid map data received, registering...');
          
          // Register map data - use full for main map, regular for shadows
          try {
            echarts.registerMap('china', mapJson);
            if (shadowJson && shadowJson !== mapJson) {
              echarts.registerMap('china_shadow', shadowJson);
            } else {
              echarts.registerMap('china_shadow', mapJson);
            }
            console.log('[Map Loader] Map registered successfully');
          } catch (regError) {
            console.error('[Map Loader] Error registering map:', regError);
            throw new Error('Failed to register map data: ' + regError.message);
          }
          
          const mapContainer = document.getElementById('chinaMap');
          if (mapContainer) {
            mapContainer.innerHTML = ''; // Clear loading message
          }
          
          try {
            setupMap(myChart, !!chinaFullJson);
            console.log('[Map Loader] Map loaded and displayed successfully from:', source.full);
          } catch (setupError) {
            console.error('[Map Loader] Error setting up map:', setupError);
            throw new Error('Failed to setup map: ' + setupError.message);
          }
        })
        .catch(error => {
          clearTimeout(timeoutId);
          if (error.name === 'AbortError') {
            console.warn(`[Map Loader] Timeout (8s) loading from ${source.full}`);
          } else {
            console.warn(`[Map Loader] Failed to load from ${source.full}:`, error.message);
          }
          // Try next source
          tryLoadMap(sourceIndex + 1);
        });
    }
    
    // Setup map with registered data
    function setupMap(chart, hasFullData) {
      // Check which cities are in the map data to show labels
      const cityNamesInMap = new Set();
      try {
        // Try to get map data after it's registered
        const mapData = echarts.getMap('china');
        if (mapData && mapData.features) {
          mapData.features.forEach(feature => {
            if (feature.properties && feature.properties.name) {
              cityNamesInMap.add(feature.properties.name);
            }
          });
        }
      } catch (e) {
        // Map might not be registered yet, that's okay
        console.warn('Could not check map data:', e);
      }
      
      const option = {
        backgroundColor: 'transparent',
        tooltip: {
          trigger: 'item',
          formatter: function(params) {
            if (params.seriesType === 'scatter') {
              return '<div style="' +
                     'line-height: 24px;' +
                     'padding: 13px 15px;' +
                     'border-top: 1px solid #16D0FE;' +
                     'border-bottom: 1px solid #16D0FE;' +
                     'background-color: rgba(6,79,124,0.92);' +
                     'box-shadow: inset 0 -10px 10px -10px #00B5FF, 0 10px 10px -10px #00B5FF, inset 0 10px 10px -10px #00B5FF, 0 -10px 10px -10px #00B5FF;' +
                     'letter-spacing: 0.2em;' +
                     'border-radius: 10%;' +
                     '">' +
                     '<div style="color: #fff; font-size: 14px; font-weight: bold;">üìç ' + params.name + '</div>' +
                     '<div style="color: #16D0FE; font-size: 12px; margin-top: 5px;">Supported City</div>' +
                     '</div>';
            }
            return params.name;
          },
          textStyle: {
            color: '#ffffff',
            fontSize: 14
          },
          padding: 0,
          borderRadius: 20,
          borderColor: 'transparent',
          backgroundColor: 'transparent'
        },
        // Âú∞ÂõæÊ∏≤ÊüìÂ±ÇÁ∫ßÈÄöËøá z Â±ûÊÄßÊù•ÊéßÂà∂ÔºåÂàõÂª∫Â§öÂ±ÇÈò¥ÂΩ±ÊïàÊûú
        geo: [
          { // Êï¥‰∏™Âú∞ÂõæÊúÄÂ§ñÈÉ®ËΩÆÂªìÁöÑÂ§ñÈò¥ÂΩ±
            map: 'china_shadow',
            z: 3,
            roam: true,
            aspectScale: 0.9, // ÈïøÂÆΩÊØî
            zoom: 1.1,
            tooltip: {
              show: false
            },
            label: {
              show: false
            },
            layoutCenter: ['50%', '50%'],
            layoutSize: '80%',
            emphasis: {
              disabled: true
            },
            select: {
              disabled: true
            },
            itemStyle: {
              normal: {
                areaColor: '#2f9fe7',
                shadowColor: 'rgba(9, 117, 185, 0.7)',
                shadowBlur: 15,
                borderWidth: 0,
                shadowOffsetY: 25,
                shadowOffsetX: 5
              },
              emphasis: {
                disabled: true
              }
            }
          },
          { // ‰∏≠Èó¥ÈÉ®ÂàÜÁöÑËìùËâ≤Èò¥ÂΩ±-‰∏ª‰ΩìÈÉ®ÂàÜ
            map: 'china_shadow',
            roam: true,
            z: 2,
            aspectScale: 0.9,
            zoom: 1.1,
            tooltip: {
              show: false
            },
            label: {
              show: false
            },
            layoutCenter: ['50%', '57%'],
            layoutSize: '80%',
            emphasis: {
              disabled: true
            },
            select: {
              disabled: true
            },
            itemStyle: {
              normal: {
                areaColor: '#38b4fc',
                borderColor: '#6dceff',
                borderWidth: 5,
                shadowColor: 'rgba(9, 117, 185, 0.7)',
                shadowBlur: 10,
                shadowOffsetY: -5,
                shadowOffsetX: -5
              },
              emphasis: {
                disabled: true
              }
            }
          },
          { // ÊúÄ‰∏ãÂ±ÇÈò¥ÂΩ±
            map: 'china_shadow',
            roam: true,
            z: 1,
            aspectScale: 0.9,
            zoom: 1.3,
            tooltip: {
              show: false
            },
            label: {
              show: false
            },
            layoutCenter: ['51%', '60%'],
            layoutSize: '80%',
            emphasis: {
              disabled: true
            },
            select: {
              disabled: true
            },
            itemStyle: {
              normal: {
                areaColor: 'rgba(4, 29, 83, 0.5)',
                borderWidth: 0
              },
              emphasis: {
                disabled: true
              }
            }
          }
        ],
        series: [
          {
            type: 'map',
            map: 'china',
            zoom: 1.1,
            z: 4,
            layoutCenter: ['50%', '50%'],
            layoutSize: '80%',
            aspectScale: 0.9,
            roam: true,
            label: {
              show: hasFullData, // Show labels if we have full data
              fontSize: 12,
              lineHeight: 16,
              padding: 0,
              borderRadius: 5,
              formatter: function (params) {
                const areaname = params.name;
                // Check if this is a supported city
                const isSupportedCity = cityData.some(city => city.name === areaname);
                if (isSupportedCity) {
                  return `{blue|${areaname}}`;
                }
                return areaname;
              },
              rich: {
                // Ê†áÁ≠æÊ†∑Âºè - ÂèÇËÄÉ echarts-map È°πÁõÆ
                blue: {
                  color: "#fff",
                  padding: 8,
                  borderRadius: 3,
                  textBorderWidth: 8,
                  textShadowBlur: 12,
                  textBorderColor: 'rgba(3, 40, 103, 0.2)',
                  textShadowColor: 'rgba(3, 40, 103, 1)',
                  backgroundColor: 'rgba(8, 136, 255, 0.8)',
                }
              }
            },
            itemStyle: {
              normal: {
                borderColor: {
                  type: 'linear',
                  x: 0,
                  y: 0,
                  x2: 0,
                  y2: 1,
                  colorStops: [
                    { offset: 0, color: '#306ca1' },
                    { offset: 0.3, color: '#41b8ff' }
                  ]
                },
                borderWidth: 3,
                areaColor: {
                  // Create a subtle texture effect using gradient
                  type: 'linear',
                  x: 0,
                  y: 0,
                  x2: 0,
                  y2: 1,
                  colorStops: [
                    { offset: 0, color: '#f5f7fa' },
                    { offset: 1, color: '#e8f4f8' }
                  ]
                }
              },
              emphasis: {
                areaColor: {
                  type: 'linear',
                  x: 0,
                  y: 0,
                  x2: 0,
                  y2: 1,
                  colorStops: [
                    { offset: 0, color: '#e0f2fe' },
                    { offset: 1, color: '#bae6fd' }
                  ]
                },
                borderColor: '#fff',
                borderWidth: 5
              }
            },
            select: {
              disabled: true
            }
          },
          {
            name: 'Supported Cities',
            type: 'scatter',
            coordinateSystem: 'geo',
            z: 12,
            data: cityData,
            symbol: 'pin',
            symbolSize: [44, 33],
            label: {
              show: true,
              position: 'bottom',
              offset: [0, 10],
              formatter: '{b}',
              fontSize: 12,
              color: '#fff',
              fontWeight: 'bold',
              backgroundColor: 'rgba(8, 136, 255, 0.8)',
              padding: [6, 10],
              borderRadius: 3,
              textBorderColor: 'rgba(3, 40, 103, 0.2)',
              textBorderWidth: 2,
              textShadowColor: 'rgba(3, 40, 103, 1)',
              textShadowBlur: 15
            },
            itemStyle: {
              color: '#4a90e2',
              shadowColor: 'rgba(74, 144, 226, 0.5)',
              shadowBlur: 8,
              shadowOffsetY: 2
            },
            emphasis: {
              label: {
                show: true,
                fontSize: 14,
                backgroundColor: 'rgba(8, 136, 255, 0.95)',
                borderColor: '#fff',
                borderWidth: 2
              },
              itemStyle: {
                color: '#2563eb',
                shadowBlur: 15,
                shadowOffsetY: 4
              },
              scale: true,
              scaleSize: 30
            }
          }
        ],
        animation: false
      };
      
      chart.setOption(option);
      
      // Add click event for interactive features
      chart.on('click', function(params) {
        if (params.seriesType === 'scatter' && params.componentType === 'series') {
          const cityName = params.name;
          const cityInfo = cityData.find(city => city.name === cityName);
          
          if (cityInfo) {
            console.log('Clicked city:', cityName, 'at coordinates:', cityInfo.value);
            
            chart.dispatchAction({
              type: 'highlight',
              seriesIndex: 1,
              dataIndex: params.dataIndex
            });
            
            setTimeout(() => {
              chart.dispatchAction({
                type: 'downplay',
                seriesIndex: 1,
                dataIndex: params.dataIndex
              });
            }, 2000);
          }
        }
      });
      
      // Handle window resize
      const resizeHandler = function() {
        chart.resize();
      };
      window.addEventListener('resize', resizeHandler);
    }
    
    // Fallback: show cities with geo coordinate system (no map background)
    function showCitiesWithGeo(chart) {
      // Create a simple geo coordinate system without map data
      // Use a minimal valid GeoJSON structure for the coordinate system
      const minimalGeoJson = {
        type: 'FeatureCollection',
        features: [{
          type: 'Feature',
          properties: { name: 'China' },
          geometry: {
            type: 'Polygon',
            coordinates: [[
              [73, 18], [135, 18], [135, 54], [73, 54], [73, 18]
            ]]
          }
        }]
      };
      
      try {
        // Register minimal map for coordinate system
        echarts.registerMap('china_fallback', minimalGeoJson);
      } catch (e) {
        console.warn('Could not register fallback map:', e);
      }
      
      const option = {
        backgroundColor: '#f8f9fa',
        tooltip: {
          trigger: 'item',
          backgroundColor: 'rgba(50, 50, 50, 0.9)',
          borderColor: '#4a90e2',
          borderWidth: 1,
          textStyle: {
            color: '#fff',
            fontSize: 14
          },
          formatter: function(params) {
            return '<div style="padding: 5px;">' +
                   '<strong style="color: #4a90e2;">üìç ' + params.name + '</strong><br/>' +
                   '<span style="color: #ccc;">Supported City</span>' +
                   '</div>';
          }
        },
        geo: {
          map: 'china_fallback',
          roam: true,
          zoom: 1.2,
          center: [105, 36],
          aspectScale: 0.75,
          itemStyle: {
            areaColor: '#e8f4f8',
            borderColor: '#b0d4e8',
            borderWidth: 1
          },
          emphasis: {
            itemStyle: {
              areaColor: '#d0e8f0'
            }
          },
          silent: false
        },
        series: [
          {
            name: 'Supported Cities',
            type: 'scatter',
            coordinateSystem: 'geo',
            data: cityData,
            symbolSize: function(value, params) {
              return 30;
            },
            symbol: 'pin',
            symbolRotate: 0,
            label: {
              show: true,
              position: 'bottom',
              offset: [0, 8],
              formatter: '{b}',
              fontSize: 12,
              color: '#333',
              fontWeight: 'bold',
              backgroundColor: 'rgba(255, 255, 255, 0.9)',
              padding: [4, 8],
              borderRadius: 4,
              borderColor: '#4a90e2',
              borderWidth: 1
            },
            itemStyle: {
              color: '#4a90e2',
              shadowColor: 'rgba(74, 144, 226, 0.5)',
              shadowBlur: 8,
              shadowOffsetY: 2
            },
            emphasis: {
              label: {
                show: true,
                fontSize: 14,
                color: '#2563eb',
                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                borderColor: '#2563eb',
                borderWidth: 2
              },
              itemStyle: {
                color: '#2563eb',
                shadowBlur: 15,
                shadowOffsetY: 4
              },
              scale: true,
              scaleSize: 25
            }
          }
        ]
      };
      
      try {
        chart.setOption(option, true); // notMerge = true to replace existing option
        console.log('Cities displayed with geo coordinate system');
      } catch (error) {
        console.error('Error setting chart option:', error);
        // Last resort: show simple list
        const mapContainer = document.getElementById('chinaMap');
        if (mapContainer) {
          const cityList = cityData.map(city => city.name).join(', ');
          mapContainer.innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">' +
            '<h4 style="color: #4a90e2; margin-bottom: 20px;">üìç Supported Cities</h4>' +
            '<p style="font-size: 16px; line-height: 2;">' + cityList + '</p>' +
            '</div>';
        }
        return;
      }
      
      // Add click event for interactive features
      chart.on('click', function(params) {
        if (params.seriesType === 'scatter' && params.componentType === 'series') {
          const cityName = params.name;
          const cityInfo = cityData.find(city => city.name === cityName);
          
          if (cityInfo) {
            console.log('Clicked city:', cityName, 'at coordinates:', cityInfo.value);
            
            chart.dispatchAction({
              type: 'highlight',
              seriesIndex: 0,
              dataIndex: params.dataIndex
            });
            
            setTimeout(() => {
              chart.dispatchAction({
                type: 'downplay',
                seriesIndex: 0,
                dataIndex: params.dataIndex
              });
            }, 2000);
          }
        }
      });
      
      window.addEventListener('resize', function() {
        chart.resize();
      });
    }
    
    // Start loading map data
    tryLoadMap(0);
  }
  
  // Initialize when page is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', waitForDOM);
  } else {
    // DOM is already ready
    waitForDOM();
  }
})();
</script>

  </body>
  </html>
